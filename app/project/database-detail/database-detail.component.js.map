{"version":3,"file":"database-detail.component.js","sourceRoot":"","sources":["../../../../../../../home/markus/code/emuDB-manager/tmp/broccoli_type_script_compiler-input_base_path-erRlJAW8.tmp/0/src/app/project/database-detail/database-detail.component.ts"],"names":[],"mappings":"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","sourcesContent":["import {Component, OnInit, OnDestroy} from \"@angular/core\";\nimport {DatabaseInfo} from \"../../types/database-info\";\nimport {ProjectDataService} from \"../../project-data.service\";\nimport {ActivatedRoute} from \"@angular/router\";\nimport {Subscription} from \"rxjs/Rx\";\n\ntype State = 'BundleLists' | 'Session' | 'Download' | 'Rename';\n\n@Component({\n\tmoduleId: module.id,\n\tselector: 'emudbmanager-database-detail',\n\ttemplateUrl: 'database-detail.component.html',\n\tstyleUrls: ['database-detail.component.css']\n})\nexport class DatabaseDetailComponent implements OnInit,OnDestroy {\n\tprivate commitList; //@todo add type\n\tprivate database:DatabaseInfo;\n\tprivate downloadTarget = this.projectDataService.getDownloadTarget();\n\tprivate newName:string = '';\n\tprivate renameError:string = '';\n\tprivate renameSuccess:string = '';\n\tprivate subCommitList:Subscription;\n\tprivate subDatabase:Subscription;\n\tprivate subParams:Subscription;\n\tprivate subTagList:Subscription;\n\tprivate subWebAppLink:Subscription;\n\tprivate state:State = 'BundleLists';\n\tprivate tagList:string[] = [];\n\tprivate webAppLink:string = '';\n\n\tconstructor(private projectDataService:ProjectDataService, private route:ActivatedRoute) {\n\t}\n\n\tngOnInit() {\n\t\tthis.subParams = this.route.params.subscribe(params => {\n\t\t\tthis.unsubscribe(false);\n\t\t\tthis.subscribe(params['name']);\n\t\t})\n\t}\n\n\tngOnDestroy() {\n\t\tthis.unsubscribe(true);\n\t}\n\n\tprivate subscribe (databaseName:string) {\n\t\tthis.subDatabase = this.projectDataService.getDatabase(databaseName).subscribe(nextDatabase => {\n\t\t\tthis.database = nextDatabase;\n\t\t});\n\n\t\tthis.subCommitList = this.projectDataService.getCommitList(databaseName).subscribe(nextCommitList => {\n\t\t\tthis.commitList = nextCommitList;\n\t\t});\n\t\tthis.subTagList = this.projectDataService.getTagList(databaseName).subscribe(nextTagList => {\n\t\t\tthis.tagList = nextTagList;\n\t\t});\n\t\tthis.subWebAppLink = this.projectDataService.getEmuWebAppURL(databaseName).subscribe(nextLink => {\n\t\t\tthis.webAppLink = nextLink;\n\t\t});\n\t}\n\n\tprivate unsubscribe(unsubscribeParams) {\n\t\tif (this.subParams && unsubscribeParams) {\n\t\t\tthis.subParams.unsubscribe();\n\t\t}\n\n\t\tif (this.subDatabase) {\n\t\t\tthis.subDatabase.unsubscribe();\n\t\t}\n\n\t\tif (this.subCommitList) {\n\t\t\tthis.subCommitList.unsubscribe();\n\t\t}\n\t\tif (this.subTagList) {\n\t\t\tthis.subTagList.unsubscribe();\n\t\t}\n\t\tif (this.subWebAppLink) {\n\t\t\tthis.subWebAppLink.unsubscribe();\n\t\t}\n\t}\n\n\tprivate editTag (commit) {\n\t\tcommit.editingTag = ! commit.editingTag;\n\t}\n\n\tprivate countTags () {\n\t\tlet count = this.tagList.length;\n\t\treturn count;\n\t}\n\n\tprivate countCommits () {\n\t\tlet count = 0;\n\n\t\tif (this.commitList) {\n\t\t\tfor (let i = 0; i < this.commitList.length; ++i) {\n\t\t\t\tfor (let j = 0; j < this.commitList[i].days.length; ++j) {\n\t\t\t\t\tcount += this.commitList[i].days[j].commits.length;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\treturn count;\n\t}\n\n\tprivate saveTag (commit) {\n\t\tcommit.saveTagError = '';\n\t\tcommit.saveTagSuccess = '';\n\n\t\tif (commit.tagLabel === '') {\n\t\t\tcommit.saveTagError = 'Empty labels are not allowed.';\n\t\t\treturn;\n\t\t}\n\n\t\tthis.projectDataService.addTag(this.database.name, commit.commitID, commit.tagLabel).subscribe(next => {\n\t\t\tcommit.saveTagSuccess = 'Successfully created tag: ' + commit.tagLabel;\n\t\t\tcommit.tagLabel = '';\n\t\t\tcommit.editingTag = false;\n\n\t\t\tif (this.subTagList) {\n\t\t\t\tthis.subTagList.unsubscribe();\n\t\t\t}\n\n\t\t\tthis.subTagList = this.projectDataService.getTagList(this.database.name).subscribe(nextTagList => {\n\t\t\t\tthis.tagList = nextTagList;\n\t\t\t});\n\t\t}, error => {\n\t\t\tcommit.saveTagError = error.message;\n\t\t});\n\t}\n\n\tprivate renameDatabase () {\n\t\tthis.renameError = '';\n\t\tthis.renameSuccess = '';\n\n\t\tif (this.database.name === this.newName) {\n\t\t\tthis.renameSuccess = 'That is already the databaseâ€™s name.';\n\t\t\treturn;\n\t\t}\n\n\t\tthis.projectDataService.renameDatabase(this.database.name, this.newName).subscribe (next => {\n\t\t\tthis.renameSuccess = 'Successfully renamed';\n\t\t\tthis.projectDataService.fetchData();\n\n\t\t\tthis.unsubscribe(false);\n\t\t\tthis.subscribe(this.newName);\n\t\t}, error => {\n\t\t\tthis.renameError = error.message;\n\t\t});\n\t}\n}\n"]}