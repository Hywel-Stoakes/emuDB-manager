{"version":3,"file":"bundle-list-detail.component.js","sourceRoot":"","sources":["../../../../../../../home/markus/code/emuDB-manager/tmp/broccoli_type_script_compiler-input_base_path-vBa7VSOU.tmp/0/src/app/project/bundle-list-detail/bundle-list-detail.component.ts"],"names":[],"mappings":"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","sourcesContent":["import {Component, OnInit, OnDestroy} from \"@angular/core\";\nimport {Subscription} from \"rxjs/Rx\";\nimport {ActivatedRoute, Router} from \"@angular/router\";\nimport {ProjectDataService} from \"../../project-data.service\";\nimport {BundleListItem} from \"../../types/bundle-list-item\";\nimport {BundleList} from \"../../types/bundle-list\";\n\ntype State = 'Info' | 'AllBundles' | 'CommentedItems';\n\n@Component({\n\tmoduleId: module.id,\n\tselector: 'emudbmanager-bundle-list-detail',\n\ttemplateUrl: 'bundle-list-detail.component.html',\n\tstyleUrls: ['bundle-list-detail.component.css']\n})\nexport class BundleListDetailComponent implements OnInit,OnDestroy {\n\tprivate allBundles: BundleListItem[] = [];\n\tprivate bundleList: BundleList;\n\tprivate commentedBundles: BundleListItem[] = [];\n\tprivate database: string = '';\n\tprivate deleteError: string = '';\n\tprivate duplicationEditor = {\n\t\tcommentedOnly: false,\n\t\teditorName: '',\n\t\tmessageError: '',\n\t\tmessageSuccess: ''\n\t};\n\tprivate infoEditor = {\n\t\tisEditing: false,\n\t\tmessageError: '',\n\t\tmessageSuccess: '',\n\t\tnewName: '',\n\t\tnewArchiveLabel: ''\n\t};\n\tprivate reallyDelete: boolean = false;\n\tprivate state: State = 'Info';\n\tprivate subBundleList: Subscription;\n\tprivate subParams: Subscription;\n\tprivate tableFormat = [\n\t\t{type: 'string', heading: 'Session', value: x => x.session},\n\t\t{type: 'string', heading: 'Bundle', value: x => x.name},\n\t\t{type: 'boolean', heading: 'Finished editing', value: x => x.finishedEditing},\n\t\t{type: 'string', heading: 'Comment', value: x => x.comment}\n\t];\n\n\tconstructor(private projectDataService: ProjectDataService,\n\t            private router: Router,\n\t            private route: ActivatedRoute) {\n\t}\n\n\tngOnInit() {\n\t\tthis.subParams = this.route.params.subscribe(nextParams => {\n\t\t\tif (typeof nextParams['archiveLabel'] === 'undefined') {\n\t\t\t\tnextParams['archiveLabel'] = '';\n\t\t\t}\n\n\t\t\tthis.subBundleList = this.projectDataService.getBundleList(\n\t\t\t\tnextParams['database'],\n\t\t\t\tnextParams['name'],\n\t\t\t\tnextParams['archiveLabel']\n\t\t\t).subscribe(nextBundleList => {\n\t\t\t\tthis.database = nextParams['database'];\n\t\t\t\tthis.setBundleList(nextBundleList);\n\t\t\t});\n\t\t});\n\t}\n\n\tngOnDestroy() {\n\t\tif (this.subBundleList) {\n\t\t\tthis.subBundleList.unsubscribe();\n\t\t}\n\t\tif (this.subParams) {\n\t\t\tthis.subParams.unsubscribe();\n\t\t}\n\t}\n\n\tprivate setBundleList (bundleList:BundleList) {\n\t\tif (bundleList === null) {\n\t\t\t// @todo what to do here?\n\t\t} else {\n\t\t\tthis.bundleList = bundleList;\n\t\t\tthis.infoEditor.newName = bundleList.name;\n\t\t\tthis.infoEditor.newArchiveLabel = bundleList.archiveLabel;\n\n\t\t\tthis.allBundles = bundleList.items;\n\t\t\tthis.commentedBundles = bundleList.items.filter(element => {\n\t\t\t\treturn element.comment !== '';\n\t\t\t});\n\t\t}\n\t}\n\n\tprivate saveEditedInfo () {\n\t\tlet newName = this.infoEditor.newName;\n\t\tlet newArchiveLabel = this.infoEditor.newArchiveLabel;\n\t\tthis.toggleEditInfo(); // that will reset this.infoEditor.newName\n\t\t// and .newArchiveLabel\n\n\t\tthis.infoEditor.messageError = '';\n\t\tthis.infoEditor.messageSuccess = '';\n\n\t\tif (this.bundleList.name === newName && this.bundleList.archiveLabel === newArchiveLabel) {\n\t\t\tthis.infoEditor.messageSuccess = 'No changes to be saved.';\n\t\t\treturn;\n\t\t}\n\n\t\tthis.projectDataService.editBundleList(\n\t\t\tthis.database,\n\t\t\tthis.bundleList.name,\n\t\t\tthis.bundleList.archiveLabel,\n\t\t\tnewName, newArchiveLabel\n\t\t).subscribe (next => {\n\t\t\tthis.infoEditor.messageSuccess = 'Successfully edited.';\n\t\t\tthis.projectDataService.fetchData();\n\n\t\t\tif (this.subBundleList) {\n\t\t\t\tthis.subBundleList.unsubscribe();\n\t\t\t}\n\t\t\tthis.subBundleList = this.projectDataService.getBundleList(\n\t\t\t\tthis.database,\n\t\t\t\tnewName,\n\t\t\t\tnewArchiveLabel\n\t\t\t).subscribe(nextBundleList => {\n\t\t\t\tthis.setBundleList(nextBundleList)\n\t\t\t});\n\t\t}, error => {\n\t\t\tthis.infoEditor.messageError = error.message;\n\t\t});\n\t}\n\n\tprivate toggleEditInfo () {\n\t\tif (this.infoEditor.isEditing) {\n\t\t\tthis.infoEditor.newName = this.bundleList.name;\n\t\t\tthis.infoEditor.newArchiveLabel = this.bundleList.archiveLabel;\n\t\t\tthis.infoEditor.isEditing = false;\n\t\t} else {\n\t\t\tthis.infoEditor.isEditing = true;\n\t\t}\n\t}\n\n\tprivate deleteBundleList () {\n\t\tthis.reallyDelete = false;\n\n\t\tthis.projectDataService.deleteBundleList(this.database, this.bundleList).subscribe(next => {\n\t\t\tthis.projectDataService.fetchData();\n\n\t\t\tthis.router.navigate(['/project/databases', this.database]);\n\t\t}, error => {\n\t\t\tthis.deleteError = error.message;\n\t\t});\n\t}\n\n\tprivate duplicateBundleList () {\n\t\tthis.duplicationEditor.messageError = '';\n\t\tthis.duplicationEditor.messageSuccess = '';\n\n\t\t// Reset editorName but keep commentedOnly.\n\t\t// This way the user won't be able to click twice without typing again\n\t\tlet editorName = this.duplicationEditor.editorName;\n\t\tthis.duplicationEditor.editorName = '';\n\n\t\tthis.projectDataService.duplicateBundleList(\n\t\t\tthis.database,\n\t\t\tthis.bundleList,\n\t\t\teditorName,\n\t\t\tthis.duplicationEditor.commentedOnly\n\t\t).subscribe (next => {\n\t\t\tthis.duplicationEditor.messageSuccess = 'Successfully duplicated' +\n\t\t\t\t' bundle list.';\n\t\t\tthis.projectDataService.fetchData();\n\t\t}, error => {\n\t\t\tthis.duplicationEditor.messageError = error.message;\n\t\t});\n\t}\n}\n"]}